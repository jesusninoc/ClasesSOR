# Práctica

## En tus máquinas virtuales de Windows Server y Ubuntu Server, configura una dirección IP estática. En Windows, hazlo desde el "Centro de redes y recursos compartidos". En Linux, edita el archivo de configuración de Netplan en /etc/netplan/.

### Red en PowerShell https://www.jesusninoc.com/11/15/9-gestion-de-la-red-en-powershell-para-administradores-de-sistemas/

### Red en Linux

#### Network
http://www.yolinux.com/TUTORIALS/LinuxTutorialNetworking.html

#### Netplan configuration examples
https://netplan.io/examples

#### To instead set a static IP address, use the addresses key, which takes a list of (IPv4 or IPv6), addresses along with the subnet prefix length (e.g. /24). Gateway and DNS information can be provided as well:

```Bash
network:
  version: 2
  renderer: networkd
  ethernets:
    enp3s0:
      addresses:
        - 10.10.10.2/24
      gateway4: 10.10.10.1
      nameservers:
          search: [mydomain, otherdomain]
          addresses: [10.10.10.1, 1.1.1.1]
```

----------
----------

## En tu Windows Server, instala el rol de servidor DHCP, crea un ámbito y autorízalo. En tu servidor Linux, instala isc-dhcp-server y configura un ámbito en /etc/dhcp/dhcpd.conf. 
```Bash
sudo apt install isc-dhcp-server

/etc/dhcp/dhcpd.conf

subnet 192.168.1.0 netmask 255.255.255.0 {
range 192.168.1.100 192.168.1.200;
option routers 192.168.1.1;
option domain-name-servers 8.8.8.8, 1.1.1.1;
default-lease-time 3600;
max-lease-time 7200;
}

sudo systemctl enable --now isc-dhcp-server

sudo tail -f /var/log/syslog | grep DHCP
```

----------
----------

## En tu Windows Server, instala el rol DNS y crea una zona de búsqueda directa para un dominio inventado (ej. smr.local). Dentro, crea un registro A para tu servidor. 
* https://www.jesusninoc.com/10/28/creacion-de-una-zona-de-busqueda-directa-y-registro-a-en-dns-en-windows-server/

## En Linux, instala BIND9, configura una zona directa en /etc/bind/named.conf.local y define sus registros en un archivo de zona. Usa nslookup desde un cliente para comprobar que ambos resuelven los nombres correctamente.
```Bash
# Instalar BIND9
sudo apt install bind9 -y

# Editar configuración de zonas
sudo nano /etc/bind/named.conf.local
# Añadir al final:
# zone "smr.local" {
#     type master;
#     file "/etc/bind/db.smr.local";
# };

# Crear archivo de zona a partir de plantilla
sudo cp /etc/bind/db.local /etc/bind/db.smr.local
sudo nano /etc/bind/db.smr.local
# Modificar el contenido principal:
# $TTL 604800
# @   IN  SOA  ns.smr.local. admin.smr.local. (
#             1         ; Serial
#             604800     ; Refresh
#             86400      ; Retry
#             2419200    ; Expire
#             604800 )   ; Negative Cache TTL
# ;
# @   IN  NS  ns.smr.local.
# ns  IN  A   192.168.1.20
# server IN  A   192.168.1.20

# Reiniciar el servicio
sudo systemctl restart bind9

# Probar la resolución
nslookup server.smr.local 192.168.1.20
```
